<%@ page contentType="text/html;charset=GBK" language="java" %>
<%@ taglib prefix="s" uri="/struts-tags"%>

<html>

	<head>
		<!-- 消除缓存 -->
		<meta http-equiv= "Expires" content= "0"/> 
		<meta http-equiv= "Cache-Control" content= "no-cache"/> 
		<meta http-equiv= "Pragma" content= "no-cache"/>
		<title>用户编辑</title>
		<link href="<%=request.getContextPath()%>/style/styleOpenWindow.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="<%=request.getContextPath()%>/js/Calendar.js"></script>
		<script type="text/javascript" src="<%=request.getContextPath()%>/js/check.js"></script>
		<script type="text/javascript" src="<%=request.getContextPath()%>/dwr/interface/dwrAction.js"></script>
		<script type="text/javascript" src="<%=request.getContextPath()%>/dwr/engine.js"></script>  
		<script type="text/javascript" src="<%=request.getContextPath()%>/dwr/util.js"></script>				
		<s:head/>
		<script type="text/javascript">
			
		// 时间控件的声明
		var c = new Calendar("c");
		document.write(c);
		function delC(flag){
			document.getElementById(flag).value = "";
		}
		function message(){
			if(document.getElementById("message").value != undefined && document.getElementById("message").value != ""){
				alert(document.getElementById("message").value);
				
			}
			
			dwrAction.getVersionByproductWithHead("25",getPatchbackback);
			
			document.getElementById('department').selectedIndex = -9;
		}
		function ch1Error(str,hstr){
			var bln = true;
			var leng = str.split(';').length;
			var hleng = hstr.split(';').length;
			if(leng > hleng){
				return true;
			}
			if(leng > 0){
				if(leng == 1){
					if(hleng > 0){
						if(hleng == 1){
							if(str == hstr){
								return false;
							}
						}else{
							for(var k=0;k<hleng;k++){
								hname = hstr.split(';')[k];
								name = str;
								if(hname == name){
									return false;
								}
							}
						}
					}
				}else{
					for(var i=0;i<leng;i++){
						bln2 = true;
						for(var k=0;k<hleng;k++){
							hname = hstr.split(';')[k];
							name = str.split(';')[i];
							if(hname == name){
								bln2 = false;
							}
						}
						if(bln2 == true){
							return true;
						}
					}
				}
			}
			return bln;
		}
		
		//选择问题版本
		function selectVersion()
		{
		    //dwrAction.getVersion(selectVersionBack);
			
		    var iWidth = 600;
			var iHeight = 400;
			var iTop = (window.screen.availHeight - 30 - iHeight) / 2;
			var iLeft = (window.screen.availWidth - 10 - iWidth) / 2;
			var win = window.open("<%=request.getContextPath()%>/page/patch/selectVersionNew.jsp", "选择版本", "width=" + iWidth + ", height=" + iHeight + ",top=" + iTop + ",left=" + iLeft + ",toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no,alwaysRaised=yes,depended=yes");

		}
		
		
		function getVersions()
		{
		    var result = new Array();
		    if(document.getElementById("tblVersion"))
		    {
		        var tempRows = document.getElementById("tblVersion").rows;
		        for(var i=1; i<tempRows.length; i++)
		        {
		            result.push(tempRows[i].cells[0].getElementsByTagName("input")[0].value);
		        }
		    }
		    
		    return result;
		}
		/*
		function selectVersionBack(fdata)
		{     
		    var tempObj = new Object();    
		    tempObj.oldData = getVersions();
		    tempObj.fdata = fdata;
		    var windowStatus = "dialogWidth:600px;dialogHeight:400px;status:no; help:no;";		    
		    var result = showModalDialog("<%=request.getContextPath()%>/page/patch/selectVersion.jsp", tempObj, windowStatus);
		    
		    
		    if (result == null)
		    {
		        return;
		    }
		   
		    var tbl = document.getElementById("tblVersion");//.innerHtml();
		              
		    var l = result.length;
		    for(var i=0; i<l; i++)
		    {
		      var tempChild = result[i]; 
                
		      var tempRow = tbl.insertRow(); 
              tempRow.style.wordBreak = "break-all";
              tempRow.style.backgroundColor = "#eeeccc";
              
              var tempCell = tempRow.insertCell(); 
              tempCell.innerHTML = "&nbsp;"+ tempChild.pname + "：" + tempChild.vname 
                                + "<input type='hidden' value='"+ tempChild.vid +"'/>";
              tempCell.className = "auditing_tab1";
              tempCell.style.textAlign = "left";  
              
              tempCell = tempRow.insertCell(); 
              tempCell.innerHTML = "<s:text name='WaittingJudege'/>";
              tempCell.className = "auditing_tab1";
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "<s:text name='Designing'/><input type='hidden' value='1'/>";
              tempCell.className = "auditing_tab1";
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "&nbsp;";
              tempCell.className = "auditing_tab1";  
              
              //0606
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "<textarea name='priority' id='priority'></textarea>";
              tempCell.className = "auditing_tab1";
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "<textarea name='isputin' id='isputin'></textarea>";
              tempCell.className = "auditing_tab1";
              //0606end
              
              tempCell = tempRow.insertCell();
              tempCell.innerHTML = "<IMG style='cursor:hand' onclick='delVersion(this)' alt='删除' src='/project/images/del.gif'>";
              tempCell.className = "auditing_tab1";
		    }

		}
		*/
		
		function delVersion(fobj)
		{
		    if(confirm("您是否确认删除该版本?"))
		    {
		        fobj.parentNode.parentNode.parentNode.removeChild(fobj.parentNode.parentNode);        
		    }
		}
		
		//检查合法
		function newRequirement(){
			// 需求名称
			var title = document.getElementById('title').value;
			if(trim(title) == ""){
				alert('请输入需求名称!');
				document.getElementById("title").focus();
				return;
			}
			
			// 需求描述
			var description = document.getElementById('description').value;
			if(trim(description) == ""){
				alert('请输入需求描述!');
				document.getElementById("description").focus();
				return;
			}
			
			//问题涉及形态
			var involvedBoard = document.getElementById('involvedBoard').value;
			if(trim(involvedBoard) == ""){
				alert('请输入问题涉及形态!\nDevices Involved is Required!');
				document.getElementById("involvedBoard").focus();
				return;
			}			
			// 问题报告人
			var patchOwner = document.getElementById('modifier').value;
			if(trim(patchOwner) == ""){
				alert('请输入问题报告人!');
				document.getElementById("modifier").focus();
				return;
			}
			
			// 问题修改人
			var newmanager = document.getElementById("modifier").value;
			var hnewmanager = document.getElementById("hmodifier").value;
			if(trim(newmanager) != "" && checkErrorChange(newmanager,hnewmanager) && newmanager != hnewmanager){
				alert("问题报告人格式不正确，请重新输入");
				document.getElementById("modifier").focus();
				return;
			}
			
			// CMM问题单号
			var CMMNumber = document.getElementById('CMMNumber').value;
			if(trim(CMMNumber) == ""){
				alert('请输入DTS问题单号!');
				document.getElementById("CMMNumber").focus();
				return;
			}	

			// 是否是安全问题
			var siteSafety = document.getElementById('siteSafety').value;
			if(siteSafety == ""){
				alert('请输入是否是安全问题!');
				document.getElementById("siteSafety").focus();
				return;
			}
			
			// 是否可维可靠问题
			var isMaintain = document.getElementById('isMaintain').value;
			if(isMaintain == ""){
				alert('请输入是否可维可靠问题!');
				document.getElementById("isMaintain").focus();
				return;
			}
			
			// 对装备有什么影响
			var isEquipmentAffect = document.getElementById('isEquipmentAffect').value;
			if(isEquipmentAffect == ""){
				alert('请输入对装备有什么影响!');
				document.getElementById("isEquipmentAffect").focus();
				return;
			}
			
			// 问题涉及局点(问题来源)
			var involvedSite = document.getElementById('involvedSite').value;
			if(trim(involvedSite) == ""){
				alert('请输入问题来源!');
				document.getElementById("involvedSite").focus();
				return;
			}
			
			
			
			// 现网版本
			var decisionVersion = document.getElementById('decisionVersion').value;
			if(trim(involvedSite) == "1" && trim(decisionVersion) == ""){
				alert('问题来源为网上问题请选择现网版本!');
				document.getElementById("decisionVersion").focus();
				return;
			}	
			
			// 判断是否填写问题版本
			if((!document.getElementById('tblVersion')) || 
			   (document.getElementById('tblVersion') && document.getElementById('tblVersion').rows.length == 1))
			{
			    alert("请输入问题存在版本!");
				return;
			}
			else
			{
			    document.getElementById('involvedVersion').value = getVersions().join(",");
			}
			
			// 问题所属组
			var department = document.getElementById('department').value;
			if (trim(department) == ""){
			//if(document.getElementById('department').selectedIndex == 0) {	
				alert('请输入问题所属组');
				document.getElementById("department").focus();
				return;
			}
			
			//所属模块
            var module = document.getElementById('module').value;
            if (trim(module) == "")
            {
                 alert('请选择所属模块!\n Module is Required!');
                 document.getElementById("module").focus();
                 return;
            }
			
			// 触发条件
			var condition = document.getElementById('condition').value;
			if(trim(condition) == ""){
				alert('请输入触发条件!');
				document.getElementById("condition").focus();
				return;
			}
			
			// 影响分析
			var impactAnalysis = document.getElementById('impactAnalysis').value;
			if(trim(impactAnalysis) == ""){
				alert('请输入影响分析!');
				document.getElementById("impactAnalysis").focus();
				return;
			}
			
			// 恢复/规避措施
			var evadeMeasure = document.getElementById('evadeMeasure').value;
			if(trim(evadeMeasure) == ""){
				alert('请输入恢复/规避措施!');
				document.getElementById("evadeMeasure").focus();
				return;
			}
			
			// 代码根因
			var rootCause = document.getElementById('rootCause').value;
			if(trim(rootCause) == ""){
				alert('请输入代码根因!');
				document.getElementById("rootCause").focus();
				return;
			}

			// 项目组决策意见及依据
			//var modifyPlan = document.getElementById('projectDecision').value;
			//if(trim(modifyPlan) == ""){
			//	alert('请输入项目组决策意见及依据!');
			//	document.getElementById("projectDecision").focus();
			//	return;
			//}
			
			// 修改方案
			var modifyPlan = document.getElementById('modifyPlan').value;
			if(trim(modifyPlan) == ""){
				alert('请输入修改方案!');
				document.getElementById("modifyPlan").focus();
				return;
			}
			
			if(document.getElementsByName("isSiteAttent")[0].checked == true){
				document.getElementById("siteAttent").value = "0";
			}else if(document.getElementsByName("isSiteAttent")[1].checked == true){
				document.getElementById("siteAttent").value = "1";
			}else{
				document.getElementById("siteAttent").value = "2";
			}
			
			document.forms[0].action = "<%=request.getContextPath()%>/patch/newRequirementSave.action";  
			document.forms[0].submit();	
			
			/*
			//判断是否已规划
			var str = document.getElementById('patch').value;
			if(str != ""){
				dwrAction.getPatchStatus(str,getPatchStatusback);
			}
			*/
		}
		function getPatchStatusback(data){
			if(data == "1"){
				document.forms[0].action = "<%=request.getContextPath()%>/patch/newRequirementSave.action";  
				document.forms[0].submit();
			}else{
				var decisionResult = document.getElementById('decisionResult').value;
				if(trim(decisionResult) == "" || trim(decisionResult) == "1"){
					if(data == "2"){
						var str = "已封版";
					}else{
						var str = "已启动";
					}
					alert("补丁状态为"+ str +"，请选择决策结论!");
					document.getElementById("decisionResult").focus();
					return;
				}else{
					document.forms[0].action = "<%=request.getContextPath()%>/patch/newRequirementSave.action";  
					document.forms[0].submit();
				}
			}
		}
		
		//////////////////////////////////////////////////////////////////////////////
		//  函数名     : onEnter                                        			    //
		//  作成日     : 2009/6/15                                                	//
		//  处理概要   : 用户的检查，回车事件处理                                               //
		//////////////////////////////////////////////////////////////////////////////
		var textname1;
		function onEnter1(flg,evt){
		    textname1 = flg;				
	       // 判断回车按钮事件
			evt = (evt) ? evt : ((window.event) ? window.event : "");
			var keyCode = evt.keyCode ? evt.keyCode : (evt.which ? evt.which :evt.charCode);
		        if(keyCode == 13){
		       	checkFlag = true;
		       	// 收件人是否为空
		      			if($(textname1).value != ""){      		
		      			
					dwrAction.getEnterUserNameOrUserNumber($(textname1).value, callback3);
				}else{
					$(textname1).focus();
				}
	    	}
		}
		function onBlur1(flg){
			textname1 = flg;
			checkFlag = true;
	       	// 收件人是否为空
	      	if($(textname1).value != ""){  
				dwrAction.getEnterUserNameOrUserNumber($(textname1).value, callback3);
	      	}
		}
		//////////////////////////////////////////////////////////////////////////////
		//  函数名     : callback                                        			    //
		//  作成日     : 2009/6/15                                                	    //
		//  处理概要   : 内容项，失焦点的处理                                                                                                                              //
		//////////////////////////////////////////////////////////////////////////////
		function callback3(data){
			
			// 弹出窗口样式
			var openStyleThis = "status:no;menu:no;dialogWidth=600px;dialogHeight=400px;dialogtop=200px;dialogleft=200px;help=no";
			if(data != ""){
				var dataArray = data.split(";");
				if(dataArray.length == 1){
					if(dataArray[0].split("?")[0] == "-1"){
						var retVal = getSameUser("<%=request.getContextPath()%>", dataArray[0], textname1);
						if(retVal == null) {
							return;
						}
						$(textname1).value = retVal.split(";")[0];
						$("h" + textname1).value = retVal.split(";")[0];
					}else {
						if(data.indexOf("/") == -1){
							alert("用户[" + data + "]不存在！");
							$(textname1).value = "";
							$("h" + textname1).value = "";
						}else{
							$(textname1).value = data.split(";")[0];
							$("h" + textname1).value = data.split(";")[0];
						}
					}
				}else{
					for(var index = 0; index < dataArray.length; index++){
						if(dataArray[index].split("?")[0] == "-1"){
						    var retVal = getSameUser("<%=request.getContextPath()%>", dataArray[index], textname1);
						    if(retVal == null) {
						    	return;
						    }
						    $(textname1).value = retVal.split(";")[0];
						    $("h" + textname1).value = retVal.split(";")[0];
						}else{
							if(dataArray[index].indexOf("/") == -1){
								alert("用户[" + dataArray[index] + "]不存在！");
								$(textname1).value = "";
								$("h" + textname1).value = "";
							}else{
								$(textname1).value = data.split(";")[0];
								$("h" + textname1).value = data.split(";")[0];
							}
						}
					}
				}
			}else{
			    alert("用户不存在!");
				$(textname1).focus();
			}
			
			$("h" + textname1).focus();
		}
		//////////////////////////////////////////////////////////////////////////////
		//  函数名     : onEnter                                        			    //
		//  作成日     : 2009/6/15                                                	//
		//  处理概要   : 用户的检查，回车事件处理                                               //
		//////////////////////////////////////////////////////////////////////////////
		var textname;
		function onEnter(flg,evt){
		   textname = flg;
	       // 判断回车按钮事件
			evt = (evt) ? evt : ((window.event) ? window.event : "");
			var keyCode = evt.keyCode ? evt.keyCode : (evt.which ? evt.which :evt.charCode);
	        if(keyCode == 13){
		       	checkFlag = true;
		       	// 收件人是否为空	         		  
		      	if(document.getElementById(textname).value != ""){      
					dwrAction.getEnterUserNameOrUserNumber(document.getElementById(textname).value, callback);
				}else{
					alert("用户必须填写!");
					document.getElementById(textname).focus();
				}
	    	}
		}
		
		function onBlur(flg){
			textname = flg;
			checkFlag = true;
	       	// 收件人是否为空
	      	if(document.getElementById(textname).value != ""){     		
	      		dwrAction.getEnterUserNameOrUserNumber(document.getElementById(textname).value, callback);
	      	}
		}
		
		//////////////////////////////////////////////////////////////////////////////
		//  函数名     : callback                                        			    //
		//  作成日     : 2009/6/15                                                	//
		//  处理概要   : 内容项，失焦点的处理                                                   //
		//////////////////////////////////////////////////////////////////////////////
		function callback(data){
			// 弹出窗口样式
			var openStyleThis = "status:no;menu:no;dialogWidth=600px;dialogHeight=400px;dialogtop=200px;dialogleft=200px;help=no";
			if(data != ""){
				var dataArray = data.split(";");
				if(dataArray.length == 1){
					if(dataArray[0].split("?")[0] == "-1"){
						var retVal = getSameUser("<%=request.getContextPath()%>", dataArray[0], textname);
						if(retVal == null)return;
						document.getElementById(textname).value = retVal;
						document.getElementById("h" + textname).value = retVal;
					}else{
						if(data.indexOf("/") == -1){
							alert("用户[" + data + "]不存在！");
							document.getElementById(textname).value = "";
							document.getElementById("h"+textname).value = "";
						}else{
							document.getElementById(textname).value = data;
							document.getElementById("h"+textname).value = data;
						}
					}
				}else{
					for(var index = 0; index < dataArray.length; index++){
						if(dataArray[index].split("?")[0] == "-1"){
							var retVal = getSameUser("<%=request.getContextPath()%>", dataArray[index], textname);
							if(retVal == null)return;
							document.getElementById(textname).value = retVal;
							document.getElementById("h" + textname).value = retVal;
						}else{
							if(dataArray[index].indexOf("/") == -1){
								alert("用户[" + dataArray[index] + "]不存在！");
								document.getElementById(textname).value = "";
								document.getElementById('h'+textname).value = "";
							}else{
								document.getElementById(textname).value = data;
								document.getElementById('h'+textname).value = data;
							}
						}
					}
				}
			}else{
			    alert("用户不存在!");
				document.getElementById(textname).focus();
			}
		}
		// 通过产品ID取得补丁列表和现网版本列表
		function getPatch(obj){
			var product = document.getElementById('product').value;
			if(product != ""){
				//取得补丁列表
				dwrAction.getPatchList(product, getPatchback);
			}
		}
		function getPatchback(data){
			dwr.util.removeAllOptions("patch");
		    dwr.util.addOptions("patch", data);
			var product = document.getElementById('product').value;
			dwrAction.getVersionByproductWithHead(product,getPatchbackback);
		}
		function getPatchbackback(data){
			dwr.util.removeAllOptions("decisionVersion");
		    dwr.util.addOptions("decisionVersion", data);
// 			document.getElementById('decisionVersion').selectedIndex = Object.keys(data).length-1;
		   var evoptions = document.getElementById('decisionVersion').options;
		    for (var i=0; i<evoptions.length; i++){
		    	if (evoptions[i].value == "" ) {
		    		evoptions[i].selected = true;
		    		break;
		    		}
		    	}
		    var product = "25";//document.getElementById('product').value;
			dwrAction.getdepartmentMapByProduct(product,getPatchbackbackback);
		}
		function getPatchbackbackback(data){
			dwr.util.removeAllOptions("department");
		    dwr.util.addOptions("department", data);
		}
		
		
		function linkModule(dep)
		{
		  var depValue = dep.value;
		  if (depValue == "")
		  {
		      dwr.util.removeAllOptions("module");		  
		  }
		  else
		  {
		      dwrAction.getFeatureByDepartment(depValue, function(data)
		      {
		          dwr.util.removeAllOptions("module");
                  dwr.util.addOptions("module", data);
		      });
		  }
		}
		
		
		function onclickAffect()
		{
			var isEquipmentAffect = document.getElementById('isEquipmentAffect').value;
			if(isEquipmentAffect == "0"){
				document.getElementById("isEquipmentAffectTxtDiv").style.display = "block";
			}else if(isEquipmentAffect == "1"){
				document.getElementById("isEquipmentAffectTxtDiv").style.display = "none";
			}
		}
		
		</script>
	</head>
	<body onload="message()">
		<s:form action="补丁管理 > 新建需求 Create new requirement" method="post" enctype="multipart/form-data">
			<div >
					<table width="100%" border="0" cellpadding="0" cellspacing="0" style="float: left">
						<tr>
							<td width="99%" valign="top">
								<div id="content">
									<div id="navigation"><s:text name="Patch_Manage"/> &gt; <s:text name="New_Requirement"/></div>
									<div id="modify">
										<table width="95%" border="0" cellspacing="0" cellpadding="0" class="modify_tab1">
											<tr>
												<td class="modify_tab1bg"><s:text name="Requirement_Info"/><!--需求信息--></td>
											</tr>
											<tr>
												<td>
											   			<table width="100%" border="1" align="center" cellpadding="0" cellspacing="0" class="txt1">
															<tr>
																<td class="tdtitle" ><font color="#ec0000">*</font><s:text name="Requirement_Name"/><!-- 需求名称 -->：</td>
																<td colspan="3">&nbsp;
																	<!--<s:textfield name="title" id="title" size="120" maxlength="60"></s:textfield>-->
																	<s:textfield name="title" id="title" size="120" maxlength="300"></s:textfield>
																</td>
															</tr>
															<tr>
																<td class="tdtitle" ><font color="#ec0000">*</font><s:text name="Requirement_Desp"/><!-- 需求描述 -->：</td>
																<td colspan="3">&nbsp;
																	<s:textarea name="description" id="description" rows="3" cols="140"></s:textarea>
																</td>
															</tr>
															<tr>
																<td class="tdtitle"><font color="#ec0000">*</font><s:text name="CMM_ID"/><!--CMM问题单号  -->：</td>
																<td>&nbsp;
																    <s:textfield name="CMMNumber" id="CMMNumber" size="20" maxlength="20"></s:textfield>
																</td>
																<td class="tdtitle" ><font color='red' id="rpatchid">*</font>问题涉及形态<!--s:text name="Invole_board"/><问题涉及单板  -->：</td>
                                                                <td >&nbsp;
                                                                    <s:textfield name="involvedBoard" id="involvedBoard" size="20"></s:textfield>
                                                                </td>															    
															</tr>
															<tr>
															    <td class="tdtitle"><font color="#ec0000">*</font><s:text name="问题报告人"/><!--问题修改人  -->：</td>
																<td>&nbsp;
																	<!--<s:textfield name="modifier" id="modifier" size="20" onkeydown="onEnter1('modifier',event)"></s:textfield>-->
																	<s:textfield name="modifier" id="modifier" size="20" onblur="onBlur1('modifier')"></s:textfield>
																    <input type="hidden" id="hmodifier" name="hmodifier"/>
																</td>
																<td class="tdtitle">
                                            					   <span class="STYLE4"><div style="vertical-align: middle"><font color="#ec0000">*</font><s:text name="是否对外体现"/><!--是否大局组关注  --></div></span>						  
                                            					 </td>
																<td >
                                            					   <span class="STYLE4"><input type="radio" name="isSiteAttent" checked="true"/><s:text name="YES"/><!-- 是 --></span>
                                                                   <span class="STYLE4"><input type="radio" name="isSiteAttent"/><s:text name="NO"/><!-- 否 --></span>
                                                                   <!--span class="STYLE4"><input type="radio" name="isSiteAttent" /><s:text name="Already_Deal"/></span--><!-- 已处理 -->								
                                            					 </td>
															</tr>
															
															<tr>
																<td class="tdtitle"><font color="#ec0000"></font><s:text name="测试人员"/><!--测试人员  -->：</td>
																<td>&nbsp;
																	<s:textfield name="questiontester" id="questiontester" size="20" ></s:textfield>
																    <input type="hidden" id="hquestiontester" name="hquestiontester"/>
																</td>
																<td class="tdtitle"><font color="#ec0000"></font><s:text name="维优人员"/><!--维优人员  -->：</td>
																<td>&nbsp;
																	<!--<s:textfield name="maintenance" id="maintenance" size="20" ></s:textfield>
																    -->
																    <input type="text" id="maintenance" name="maintenance"/>
																    <input type="hidden" id="hmaintenance" name="hmaintenance"/>
																</td>
															</tr>
															
															<tr>
															    <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="Dep"/><!--问题所属组  -->：</td>
																<td >&nbsp;
																	<s:select size="1" id="department" name="department" onchange="linkModule(this)" headerKey="-9" headerValue="--请选择--" list="departmentList"  listKey="id" listValue="name"></s:select>
																</td>
															     <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="Module"/><!-- 所属模块 -->：</td>
																<td >&nbsp;
																    <select id="module" name="module" style="width:150px;">
																        <option value="">--请选择--</option>
																    </select>
																</td>
															</tr>
															<tr>                                      					 
																<td class="tdtitle" ><font color='red' id="rpatchid">*</font>问题来源<!--s:text name="Invole_board"/><问题涉及单板  -->：</td>
                                                                <td >&nbsp;                                                                    
                                                                    <s:select id="involvedSite" name="involvedSite" headerKey="" headerValue="--请选择--" list="defectSourceList" listKey="id" listValue="name"></s:select>
                                                                </td>
                                                                <td class="tdtitle"><font color="#ec0000"></font><s:text name="Net_Version"/><!-- 现网版本 -->：</td>
																<td class="STYLE4">&nbsp;
																    <s:select id="decisionVersion" name="decisionVersion" headerKey="-9" headerValue="--请选择--" list="versionList"  listKey="id" listValue="name"></s:select>非网上问题，可不填.
																</td>
															</tr>
															<tr>
															     <td class="tdtitle">
                                            					   <span class="STYLE4"><div style="vertical-align: middle"><font color="#ec0000">*</font><s:text name="是否是安全问题"/><!--是否是安全问题  --></div></span>						  
                                            					 </td>
                                            					 <td >&nbsp; 
                                            					 <select id="siteSafety" name="siteSafety" style="width:150px;">
                                                                     <option value="">--请选择--</option>
                                                                     <option value="0">是</option>
                                                                     <option value="1">否</option>
                                                                 </select>
                                            					 </td>
																<td class="tdtitle" >
																<span class="STYLE4"><div style="vertical-align: middle"><font color="#ec0000">*</font><s:text name="是否可维可靠问题"/><!--是否可维可靠问题  --></div></span>
																</td>
                                                                <td >&nbsp;   
                                                                <select id="isMaintain" name="isMaintain" style="width:150px;">
                                                                     <option value="">--请选择--</option>
                                                                     <option value="0">是</option>
                                                                     <option value="1">否</option>
                                                                 </select>
                                                                </td>
															</tr>
															<tr>
															     <td class="tdtitle">
                                            					   <span class="STYLE4"><div style="vertical-align: middle"><font color="#ec0000">*</font><s:text name="对装备有什么影响"/><!--对装备有什么影响 --></div></span>						  
                                            					 </td>
                                            					 <td colspan="3">
                                            					 
                                            					  &nbsp;   
                                            					  <select id="isEquipmentAffect" name="isEquipmentAffect" style="width:150px;" onchange="onclickAffect();">
                                                                     <option value="">--请选择--</option>
                                                                     <option value="0" >是</option>
                                                                     <option value="1" >否</option>
                                                                 </select>
                                            					                                                                   
                                            					   <div id="isEquipmentAffectTxtDiv" >
                                            					   <table><tr><td><textarea id="isEquipmentAffectTxt" name="isEquipmentAffectTxt" rows="6" cols="60" ></textarea>
                                            					   </td><td class="STYLE4">提示:<br/>1.命令是否发生变化，包括增加、删除、修改；<br/>2.命令回显是否发生变化，如有变化，详细给出变化后的回显；<br/>3.功能修改是否涉及时延变化，单板注册时间、软件加载时间等；<br/>4.功能的修改是否导致单板复位；<br/>5.功能修改是否导致单板注册的依赖关系发生变化.</td></tr>
                                            					   </table>
                                            					   </div>
                                            					 </td>
                                            					 
															</tr>
															<tr>
																<td class="tdtitle"><font color="#ec0000">*</font><s:text name="Question_Exist_Version"/><!--问题存在版本  -->：<br><A onclick="selectVersion()" href="###"><img src="/project/images/new_select.bmp"></A></td>
																<td colspan="3">
																<!-- 0615 -->
																<input type="hidden" id="openerhiddeninput" value="" />
																    <div id="divVersion">
																        <table id='tblVersion' class='modify_tab1' style='height:100%' cellSpacing='0' cellPadding='0' width='100%' border='0'>
												                           <TR>
												                             <TD class='modify_tab1bg5'><s:text name="Version"/><!-- 版本 --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="Statu"/><!-- 状态 --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="SchemeReviewStatu"/><!--方案评审状态  --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="PatchVersion"/><!--补丁版本号  --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="PatchType"/><!--补丁类型  --></TD>
												                               <TD class='modify_tab1bg5'>补丁序号<!--s:text name="IssueNum"/>< 合入问题单号 --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="IsPromiseOut"/><!--是否对外承诺  --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="PromiseDeliverDate"/><!--承诺交付时间  --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="PatchMaker"/><!--制作人  --></TD>
												                               
												                               
												                               <!-- 0606 -->
												                               <TD class='modify_tab1bg5'>优先级<!--<s:text name="priority"/>--><!--优先级--></TD>
												                               <TD class='modify_tab1bg5'>是否合入 <!--<s:text name="isputin"/>--><!--是否合入 --></TD>												                               
												                               <!-- 0606end -->
												                               <TD class='modify_tab1bg5'><s:text name="Remark"/><!--备注  --></TD>
												                               <TD class='modify_tab1bg5'><s:text name="Operator"/><!--操作  --></TD>  
												                           </TR>  
												                         </table>       
																    </div>																	    														    
																</td>																
															</tr>
															<tr style="visibility:hidden;display:none">
															    <td>
																    <input name="involvedVersion" id="involvedVersion"/>	
																</td>
															</tr>
															<tr>
															    <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="TiggerCond"/><!--触发条件  -->：</td>
																<td colspan="3">&nbsp;
																	<textarea id="condition" name="condition" rows="6" cols="140"><s:property value="occurOptions"/></textarea>
																</td>
															</tr>
															<tr>
															    <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="CodeRootReason"/><!-- 代码根因 -->：</td>
																<td colspan="3">&nbsp;
																	<textarea name="rootCause" id="rootCause" rows="6" cols="140"></textarea>
																</td>
															</tr>
															<tr>
															    <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="InfluenceAnaly"/><!--影响分析  -->：</td>
																<td colspan="3">&nbsp;
																	<textarea name="impactAnalysis" id="impactAnalysis" rows="6" cols="140"></textarea>
																</td>
															</tr>															
															<tr>
															    <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="ModifyPlan"/><!--修改方案  -->：</td>
																<td colspan="3">&nbsp;
																	<textarea name="modifyPlan" id="modifyPlan" rows="6" cols="140"><s:property value="modifyPlan"/></textarea>
																</td>
															</tr>															
															<tr>
															    <td class="tdtitle" ><font color="#ec0000">*</font><s:text name="ResumeEvadeMethod"/><!--恢复/规避措施-->：</td>
																<td colspan="3">&nbsp;
																	<textarea name="evadeMeasure" id="evadeMeasure" rows="6" cols="140"></textarea>
																</td>
															</tr>
															<tr>
															    <td class="tdtitle" ><s:text name="DecisionOpinionAndAccord"/><!-- 项目组决策意见及依据 -->：</td>
																<td colspan="3">&nbsp;
																	<textarea name="projectDecision" id="projectDecision" rows="6" cols="140"><s:property value="projectDecision"/></textarea>
																</td>
															</tr>
															<tr>
															    <td class="tdtitle" ><s:text name="decisionOpinion"/><!-- 决策意见 -->：</td>
																<td colspan="3">&nbsp;
																	<textarea id="decisionOpinion" name="decisionOpinion" rows="6" cols="140"><s:property value="decisionOpinion"/></textarea>
																</td>
															</tr>
															
														</table>
												</td>
											</tr>
										</table>
										<table border="0" align="center" cellpadding="0" cellspacing="0" id="butttab">
											<tr>
												<td>
											    	<a href="###" onclick='newRequirement()'><img src="<%=request.getContextPath()%>/images/new_submit.bmp"/></a>&nbsp;
											    </td>
											</tr>
										</table>
									</div>
								</div>
							</td>
						</tr>
					</table>
				</div>
			<s:hidden name="message" id="message"/>	
			<s:hidden id="siteAttent" name="siteAttent"></s:hidden>
		</s:form>  
	</body>
</html>
